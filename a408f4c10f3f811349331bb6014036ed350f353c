{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ebf42918_e294a3ac",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 238,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "Actually this checks for /data/data. /data/user/0 is handled below.",
      "range": {
        "startLine": 238,
        "startChar": 11,
        "endLine": 238,
        "endChar": 27
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d2c8945a_f7ea1522",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 318,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "Nit: dup can fail.",
      "range": {
        "startLine": 318,
        "startChar": 37,
        "endLine": 318,
        "endChar": 40
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fad0f71b_34dc7719",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 3911,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "Notably",
      "range": {
        "startLine": 3911,
        "startChar": 3,
        "endLine": 3911,
        "endChar": 10
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ed33142b_07fd13c6",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 3936,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "Please fix this ERROR reported by Common Typos: Common typo found: \"the the\" -- should it be \"the\"?\n\nAnalyzer Description: Linter for catching common typos motivated by go/todo-fail and go/lol-codesearch. Shared with google3 common typos library go/common-typos.\nOwner: ayeaye-team@google.com\n\nCommon typo found: \"the the\" -- should it be \"the\"?\nNote: a line containing \"common_typos_disable\" or \"common_typos_enable\" will turn off or on (respectively) the linter for subsequent lines in the file. Alternatively include the token \"NOTYPO\" within a line to skip typo linting that line or include \u0027No-Typo-Check: \u003creason\u003e\u0027in the commit message.",
      "range": {
        "startLine": 3936,
        "startChar": 25,
        "endLine": 3936,
        "endChar": 32
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9964d426_29fe27af",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 3947,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "That feels like a slightly weak check. Check it\u0027s a valid app uid, or at least not a system uid?",
      "range": {
        "startLine": 3947,
        "startChar": 4,
        "endLine": 3947,
        "endChar": 21
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c868808a_59848c1b",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 8
      },
      "lineNbr": 3982,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "I think this won\u0027t work for userId !\u003d 0.\nThe file will have the combined uid, encoding userId + appId.",
      "range": {
        "startLine": 3982,
        "startChar": 7,
        "endLine": 3982,
        "endChar": 64
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65278034_487c6aa8",
        "filename": "cmds/installd/binder/android/os/IInstalld.aidl",
        "patchSetId": 8
      },
      "lineNbr": 137,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-08-07T16:36:46Z",
      "side": 1,
      "message": "ok, this is definitely an overkill. we are doing way more sensetive operations in installd just by checking a path. let\u0027s do just that",
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e8008c4f_e447ac7b",
        "filename": "cmds/installd/binder/android/os/IInstalld.aidl",
        "patchSetId": 8
      },
      "lineNbr": 137,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2023-08-07T18:16:26Z",
      "side": 1,
      "message": "Err, I thought you were concerned about the arguments spoofed by the caller / system server?  Why is path checking sufficient?\n\nWhat is the way more sensitive operation?  Besides the fs-verity ioctl, everything else is read-only.",
      "parentUuid": "65278034_487c6aa8",
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89941a13_8ae382c0",
        "filename": "cmds/installd/binder/android/os/IInstalld.aidl",
        "patchSetId": 8
      },
      "lineNbr": 137,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-08-07T18:33:46Z",
      "side": 1,
      "message": "Sorry, I might not have been clear enough.\nMy personal concern is that an app can put a symlink in their path.\nThe concern of security team is that system_server can send an invalid path.\n\nThey are both can be addressed by using a rather simple validation-and-open e.g.:\n\nhttps://source.corp.google.com/h/googleplex-android/platform/superproject/main/+/main:system/vold/Utils.cpp;l\u003d1727-1762?q\u003dopenat%20vold\u0026sq\u003drepo:googleplex-android%2Fplatform%2Fsuperproject%2Fmain%20b:main\n\nre: more sensitive operation. not in this method, but across installd",
      "parentUuid": "e8008c4f_e447ac7b",
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63471025_8399c69d",
        "filename": "cmds/installd/binder/android/os/IInstalld.aidl",
        "patchSetId": 8
      },
      "lineNbr": 137,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2023-08-07T18:59:37Z",
      "side": 1,
      "message": "The security concern isn\u0027t an \"invalid path\" (from the link, I assume by \"invalid\" you imply only the path \"structure\", i.e. symlink and existence), but perhaps \"arbitrary path\".  I thought we\u0027re treating installd as a super privilege domain and want a high security bar.  For example, we need to consider what can happen when a system server is compromised, right? Otherwise why the domain separation?  Arguably we\u0027re only enabling fs-verity to files, so it isn\u0027t a huge problem if we allow an attacker to abuse the API.\n\nDoes anyone on security feel a path check is sufficient?  Not sure who on security has more knowledge about installd.  Otherwise, I don\u0027t feel this is an overkill given the installd privilege.",
      "parentUuid": "89941a13_8ae382c0",
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03280907_facfde48",
        "filename": "cmds/installd/binder/android/os/IInstalld.aidl",
        "patchSetId": 8
      },
      "lineNbr": 138,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-08-07T08:32:57Z",
      "side": 1,
      "message": "// Intentionally left blank\n\nOr a better explanation? Both to make it less ugly, and to make it clearer why there are no methods?",
      "range": {
        "startLine": 137,
        "startChar": 0,
        "endLine": 138,
        "endChar": 5
      },
      "revId": "a408f4c10f3f811349331bb6014036ed350f353c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}