{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b24e0ce3_6af7a86f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:02:46Z",
      "side": 1,
      "message": "have you tried corrupting the labels manually to trigger this code path, and see if it actually works? I mean, that the files are accessible in time if the call is in a separate thread",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 15
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d09e907a_00c24c88",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-11-28T21:15:44Z",
      "side": 1,
      "message": "if we are talking about 1,000,000s of files then they won\u0027t be accessible for minutes. the trade off here is between the whole phone is unusable and a single app potentially broken",
      "parentUuid": "b24e0ce3_6af7a86f",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 15
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8eb27165_8977c1a5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-12-05T17:51:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d09e907a_00c24c88",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 15
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8687bcfa_c2d465ce",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:02:46Z",
      "side": 1,
      "message": "t",
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9ee2d5d4_a8d8df1b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:13:37Z",
      "side": 1,
      "message": "sorry, this was a misclick",
      "parentUuid": "8687bcfa_c2d465ce",
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7949220_f73e9538",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:02:46Z",
      "side": 1,
      "message": "1. is there a way to reuse some existing thread for this? I\u0027m pretty sure you will get pinged by the system health team because of a new thread creation that\u0027s not known to their systems\n\n2. if there was a crash, is there a chance we\u0027re getting a few of those \u0027in progress\u0027 packages, and end up creating multiple threads this way?",
      "range": {
        "startLine": 582,
        "startChar": 12,
        "endLine": 582,
        "endChar": 45
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8ed1319_dc8bd330",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:02:46Z",
      "side": 1,
      "message": "how can we guarantee that some inner files are ready by the time this function returns? what if someone is trying to access them, or even setting up an attack and the function takes longer than their code?",
      "range": {
        "startLine": 582,
        "startChar": 17,
        "endLine": 582,
        "endChar": 23
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fccc6759_ef28e2ac",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:13:37Z",
      "side": 1,
      "message": "After reading the bug - it looks like what we actually need here is a way to resume labeling on the next call instead of restarting it. Do you know what is the slower part of the operation - walking directories or labeling the files? if we could walk directory fast enough it could be possible to periodically update the \u0027in progress\u0027 label to point at the current path, so the operation would continue from that point only. \n\nBut if walking it is also slow, I don\u0027t see any way other than making the app unavailable until the operation completes, and only then restoring it in PackageManager - so we could at least allow the system to boot up, but not let anyone access incorrectly labeled apps",
      "parentUuid": "d7949220_f73e9538",
      "range": {
        "startLine": 582,
        "startChar": 12,
        "endLine": 582,
        "endChar": 45
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "928a1c87_bb4ffa45",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-11-28T21:15:44Z",
      "side": 1,
      "message": "Files can be only accessed from the same uid. i.e. an attacker has to:\n1. wait for many-many OTAs to obtain the same UID,\n2. AND for the user to reboot the phone during label update, at first reboot after an OTA\n3. AND to know the exact path to the file,\n4. and the file has to be available (label not changed).\nI find all the above highly unlikely.\n\nBesides, an app which is continuously hanging during OTA, will most probably be flagged and fixed.",
      "parentUuid": "b8ed1319_dc8bd330",
      "range": {
        "startLine": 582,
        "startChar": 17,
        "endLine": 582,
        "endChar": 23
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3dd3d7bd_f52efcd2",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-11-28T21:15:44Z",
      "side": 1,
      "message": "Resuming of a multi-minutes process will annoy the user even further, and will probably result in more reboots. And this is exactly what we want to avoid.\n\"How many reboots does it take to finally boot the phone?\"",
      "parentUuid": "fccc6759_ef28e2ac",
      "range": {
        "startLine": 582,
        "startChar": 12,
        "endLine": 582,
        "endChar": 45
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc3aa68f_e68ca7d9",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-12-05T17:51:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3dd3d7bd_f52efcd2",
      "range": {
        "startLine": 582,
        "startChar": 12,
        "endLine": 582,
        "endChar": 45
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "138baf0c_23481e04",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 582,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-12-05T17:51:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "928a1c87_bb4ffa45",
      "range": {
        "startLine": 582,
        "startChar": 17,
        "endLine": 582,
        "endChar": 23
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2355c0a0_c4fbe7c5",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 584,
      "author": {
        "id": 1080076
      },
      "writtenOn": "2023-11-28T20:02:46Z",
      "side": 1,
      "message": "nit: this isn\u0027t required as it\u0027s the default condition",
      "range": {
        "startLine": 584,
        "startChar": 42,
        "endLine": 584,
        "endChar": 54
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c98d42ee_dcf24c82",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 1
      },
      "lineNbr": 584,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-11-28T21:15:44Z",
      "side": 1,
      "message": "too much java recently 😞",
      "parentUuid": "2355c0a0_c4fbe7c5",
      "range": {
        "startLine": 584,
        "startChar": 42,
        "endLine": 584,
        "endChar": 54
      },
      "revId": "c555dc8c2dee61ebea765c6cf61ac5478d51909a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}