{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "29b0bbc0_22cf0c86",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-07-31T20:34:15Z",
      "side": 1,
      "message": "we need packageName and filePath.\nthis method needs to:\n1. validate the path belongs to the package private data folder,\n2. lock the package using LOCK_PACKAGE()\n\nI think this will mean \"no PFD API\", we might be OK as we are never supposed to be working for any FD",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d15b1a2_2e0016f4",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2023-07-31T21:00:07Z",
      "side": 1,
      "message": "OK, I think we can drop the PFD API for simplicity. Then we can just validate the path in system server, and remove all the checks here.  Will upload the change later.",
      "parentUuid": "29b0bbc0_22cf0c86",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c748a45_c9692c25",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-07-31T21:18:40Z",
      "side": 1,
      "message": "In fact, we need to validate paths both in system_server, and here.\nOr just keep single validation point, in installd.\n\nThe security requirements for installd are to validate its inputs in case someone can spoof AIDL requests to installd.",
      "parentUuid": "7d15b1a2_2e0016f4",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5e4602ed_034b8338",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2023-07-31T21:34:59Z",
      "side": 1,
      "message": "They will have to spoof the calling UID to pass `ENFORCE_UID(AID_SYSTEM)`.  If they can do that, they can manipulate almost all functions here and in fact everywhere?",
      "parentUuid": "0c748a45_c9692c25",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0475689e_9f6bcd26",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-07-31T21:40:04Z",
      "side": 1,
      "message": "Maybe, but these are the requirements.",
      "parentUuid": "5e4602ed_034b8338",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0400753b_469fd57f",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2023-07-31T22:03:56Z",
      "side": 1,
      "message": "Do you know what code does the check for such a requirement?  Where is the requirement stated?  I was looking for shared code for the requirement, but many of them don\u0027t implement such a check (e.g. getAppSize, linkNativeLibraryDirectory).",
      "parentUuid": "0475689e_9f6bcd26",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25508160_b0fec2b5",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-07-31T22:06:47Z",
      "side": 1,
      "message": "Example bug (for the previous version of enableFsVerity lol) b/216112933",
      "parentUuid": "0400753b_469fd57f",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ce52f13_9c694be2",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1166043
      },
      "writtenOn": "2023-07-31T22:10:09Z",
      "side": 1,
      "message": "I don\u0027t think we have code that checks for \"private data folder\". I guess you need to define it yourself, similarly to what you were going to do in system_server perhaps?",
      "parentUuid": "25508160_b0fec2b5",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e2ccc39_496eec94",
        "filename": "cmds/installd/InstalldNativeService.cpp",
        "patchSetId": 3
      },
      "lineNbr": 3871,
      "author": {
        "id": 1137063
      },
      "writtenOn": "2023-07-31T22:35:00Z",
      "side": 1,
      "message": "Should we reconsider just allowing apps to use FS_IOC_ENABLE_VERITY?  Then this API would not be needed at all.",
      "parentUuid": "2ce52f13_9c694be2",
      "range": {
        "startLine": 3871,
        "startChar": 53,
        "endLine": 3871,
        "endChar": 97
      },
      "revId": "d9421062d57dfd411aa029569d8c7a2c807bc382",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}