{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4ea2455b_dcee7e8c",
        "filename": "libs/binder/RpcServer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 776,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T00:29:37Z",
      "side": 1,
      "message": "I feel like you should pick one or the other strategy with #ifdef/#ifndef Trusty stuff. Either #ifdef them all in place and don\u0027t move any code like you did here, or move *all* the code so that the you have\nBoth\nAndroid-only\nTrusty-only",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ac80410d_397e6f37",
        "filename": "libs/binder/RpcServer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 776,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2024-01-23T01:36:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4ea2455b_dcee7e8c",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eed8c8aa_60abe059",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 37,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T00:29:37Z",
      "side": 1,
      "message": "You shouldn\u0027t need to forward declare RpcServer since you declare it fully just below",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fa39b8d9_27d412ec",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 37,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2024-01-23T01:36:14Z",
      "side": 1,
      "message": "Oh right, this used to be the other one but now I can just delete it.",
      "parentUuid": "eed8c8aa_60abe059",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6330aa91_a6def36c",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 113,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T00:29:37Z",
      "side": 1,
      "message": "I feel like having an extra definition of the ACL struct in binder is not a good plan. Would it really be so bad to use the C structs here?",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "734d8d01_a589353c",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 113,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2024-01-23T01:36:14Z",
      "side": 1,
      "message": "Back in the original change, we had a whole discussion about avoiding lifetime issues for the pointees, e.g., the UUIDs (see https://android-review.git.corp.google.com/c/platform/frameworks/native/+/1931393/comment/6a43758a_22479655/).\n\nThe C++ structures solve that more elegantly, but I guess copying the C ones would work too (with more manual memory management). Should we still switch?",
      "parentUuid": "6330aa91_a6def36c",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "589dfab7_18ea8e18",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 113,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T19:24:09Z",
      "side": 1,
      "message": "If this has already been discussed, we can take the previous resolution. Usually I prefer to have exactly one ground truth for where a structure is defined (so not copying the C one, but #include ing it).\n\nI un-resolved this because looking at the comment stream that was linked, it does not sound like Jiyong was suggesting that you create a C++ variant of the port acl, but rather just pass in a shared pointer variant of the port acl...",
      "parentUuid": "734d8d01_a589353c",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ba865df_94f7a3f8",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T00:29:37Z",
      "side": 1,
      "message": "Pretty sure this line can just go away? RpcServer doesn\u0027t need to be a friend of itself.",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f4534942_0d10fae5",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 291,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2024-01-23T01:36:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9ba865df_94f7a3f8",
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c74889f7_fbf23eb9",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 340,
      "author": {
        "id": 1416371
      },
      "writtenOn": "2024-01-23T00:29:37Z",
      "side": 1,
      "message": "This comment is no longer accurate (\"both this class\"), but also it\u0027s unnecessary - this class has multiple data members which are uncopiable, so the copy constructor is already gone. If you want to delete them for documentation, then this should go outside the #ifdef, because `RpcServer` also doesn\u0027t have any copy constructors.\n\nAdditionally, the rationale here makes no sense - `mTrustyUuidPtrs` holds pointers, yes, but into a `shared_ptr`, not something stored inline with the class. These pointers would not be invalidated on copy, as they point to a heap allocated acl.",
      "range": {
        "startLine": 336,
        "startChar": 0,
        "endLine": 340,
        "endChar": 46
      },
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bb361a3b_a63cf217",
        "filename": "libs/binder/include/binder/RpcServer.h",
        "patchSetId": 3
      },
      "lineNbr": 340,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2024-01-23T01:36:14Z",
      "side": 1,
      "message": "`mTipcPortAcl` holds a pointer into `mTrustyUuidPtrs.data()` which I think could change on a copy, but the rest is true.\n\nI switched to an alternative approach: wrap the \"pinned\" data in a `std::unique_ptr` to guarantee it cannot move.",
      "parentUuid": "c74889f7_fbf23eb9",
      "range": {
        "startLine": 336,
        "startChar": 0,
        "endLine": 340,
        "endChar": 46
      },
      "revId": "c7e1eed8e3e31e42f5072c360afd972487b10763",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}