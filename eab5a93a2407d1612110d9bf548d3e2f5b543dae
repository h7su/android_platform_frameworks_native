{
  "comments": [
    {
      "key": {
        "uuid": "59b7804c_cd171edf",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "likely not needed if line 65 is deleted (see below)",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_f3de68a1",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 32,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "59b7804c_cd171edf",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "59b7804c_8defd68c",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 65,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "you only have read access to this directory. This is always going to fail.",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39bc8c31_3d87f28a",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 65,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T17:46:46Z",
      "side": 1,
      "message": "minor correction: In most cases, you won\u0027t actually see a failure here, because selinux_android_restorecon only changes the security label on the directory if it needs changing. If the security label on the directory is already correct, then this is a no-op.\n\nRegardless, this isn\u0027t needed in the dumpstate code, and if the security label was actually incorrect, the permissions granted in https://android-review.googlesource.com/102258 are insufficient to allow this to succeed.",
      "parentUuid": "59b7804c_8defd68c",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_376ffac7",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 65,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "59b7804c_8defd68c",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "59b7804c_8d3cf64b",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "the stat, then open (line 76) feels redundant and racy. Why not just try the open unconditionally. I don\u0027t see what value the stat gives you.\n\nIf you really want to assert it\u0027s a regular file, then do the open, fstat() the file descriptor, and then do the check.",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_f7d3b23f",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Changed to an open and fstat. I don\u0027t check the fd directly since the stat will fail if the file doesn\u0027t exist.",
      "parentUuid": "59b7804c_8d3cf64b",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "79b2845d_3388cb61",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 75,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2014-07-23T03:02:53Z",
      "side": 1,
      "message": "(this is what the stat is for. but yeah, fstat on the result of open would be better all round.)",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39bc8c31_51ad871d",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "O_NOFOLLOW please",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "193d089f_17b91e05",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "39bc8c31_51ad871d",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39bc8c31_b19313db",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "if the file isn\u0027t found (line 73 returns false), data[i].name remains uninitialized. This could cause problems later.\n\nRecommend explicitly zeroing out tombstone_data immediately before calling get_tombstones_fds()",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_f6aad69f",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 77,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "I changed this works so I don\u0027t think it requires zeroeing out the structure.",
      "parentUuid": "39bc8c31_b19313db",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "79b2845d_9336d7f8",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2014-07-23T02:58:59Z",
      "side": 1,
      "message": "This feels fragile, and definitely assumes NUM_TOMBSTONES \u003c\u003d 10 and the tombstone file format ends with digits. It might be clearer if you were to use snprintf instead.",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_7697c669",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 80,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "79b2845d_9336d7f8",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "59b7804c_cd2d5e1c",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 465,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2014-07-23T02:56:11Z",
      "side": 1,
      "message": "i guess it doesn\u0027t matter if we leak all the tombstone fds since we\u0027re about to exit anyway...",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_961a7260",
        "filename": "cmds/dumpstate/dumpstate.c",
        "patchSetId": 2
      },
      "lineNbr": 465,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "That\u0027s what I\u0027m assuming.",
      "parentUuid": "59b7804c_cd2d5e1c",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39bc8c31_d175f7dc",
        "filename": "cmds/dumpstate/utils.c",
        "patchSetId": 2
      },
      "lineNbr": 224,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2014-07-23T02:56:11Z",
      "side": 1,
      "message": "why not leave the close inside dump_file_from_fd, since both callers want it?",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f93914b5_f629f674",
        "filename": "cmds/dumpstate/utils.c",
        "patchSetId": 2
      },
      "lineNbr": 224,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2014-07-23T22:12:00Z",
      "side": 1,
      "message": "Yeah, I decided to move the close info the dump_file_from_fd.",
      "parentUuid": "39bc8c31_d175f7dc",
      "revId": "eab5a93a2407d1612110d9bf548d3e2f5b543dae",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}