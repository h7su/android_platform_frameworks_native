{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c646b732_0e664bad",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 53,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-14T05:52:16Z",
      "side": 1,
      "message": "Maybe add a comment that the passed-in value must be maintained by the caller? Otherwise, a caller may do\n\n```\nIoVecList({.iov_base \u003d ..., .iov_len \u003d ...})\n``` \n\nwhich breaks because we are only taking the pointer to head, not copying the head.\n\n(Same for the one below)",
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "182091a8_d4088b01",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 53,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2021-12-14T22:38:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c646b732_0e664bad",
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26778c67_6162201e",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-14T05:52:16Z",
      "side": 1,
      "message": "I think this can be std::initializer_list\u003ciovec\u003e to avoid the templates on each integer.",
      "range": {
        "startLine": 61,
        "startChar": 27,
        "endLine": 61,
        "endChar": 49
      },
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5640d443_39a053f9",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2021-12-14T06:41:08Z",
      "side": 1,
      "message": "std::initializer_list\u003ciovec\u003e just wraps the values in a temporary array, wouldn\u0027t we still need a permanent data structure somewhere? Where would that be stored?\n\nAlternatively, I think interruptableWriteFully could take an std::initializer_list\u003ciovec\u003e directly, but then the iovec array would always be fixed per call site.",
      "parentUuid": "26778c67_6162201e",
      "range": {
        "startLine": 61,
        "startChar": 27,
        "endLine": 61,
        "endChar": 49
      },
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "764ea613_b267ff0e",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-14T20:44:24Z",
      "side": 1,
      "message": "Good point. https://en.cppreference.com/w/cpp/utility/initializer_list says:\n\n\u003e The underlying array is a temporary array of type const T[N], in which each element is copy-initialized\n\nAn SO answer https://stackoverflow.com/a/61826197 even suggests that it can be allocated on the data segment.\n\nBut, since the storage is NOT specified, we don\u0027t know how Android\u0027s libc++ implements it. (You could poke into the implementation though) \n\nPlease disregard the original comment I have. This is looks good to me. We only need N\u003d1 and N\u003d3 cases right now, right?\n\nI\u0027ll also leave this to Jiyong / Steven to comment.",
      "parentUuid": "5640d443_39a053f9",
      "range": {
        "startLine": 61,
        "startChar": 27,
        "endLine": 61,
        "endChar": 49
      },
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c19c19d_5584ae99",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1809582
      },
      "writtenOn": "2021-12-14T21:20:43Z",
      "side": 1,
      "message": "I looked at vanilla LLVM libcxx, and std::initializer_list is implemented as a pointer+size pair. The thing with this type is that afaik it\u0027s a magic type where the pointer points to a temporary array holding the values, and the compiler extends the lifetime of that array to match the lifetime of the std::initializer_list object, but only as a temporary. It\u0027s recommended against (I think it\u0027s UB) to store the initializer_list anywhere permanent, like a class member.",
      "parentUuid": "764ea613_b267ff0e",
      "range": {
        "startLine": 61,
        "startChar": 27,
        "endLine": 61,
        "endChar": 49
      },
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5b5c750a_07ccd0c0",
        "filename": "libs/binder/include/binder/RpcTransport.h",
        "patchSetId": 9
      },
      "lineNbr": 61,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2021-12-14T21:22:43Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9c19c19d_5584ae99",
      "range": {
        "startLine": 61,
        "startChar": 27,
        "endLine": 61,
        "endChar": 49
      },
      "revId": "0542ef60c3ff18a96defc7dc008034daf1361310",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}