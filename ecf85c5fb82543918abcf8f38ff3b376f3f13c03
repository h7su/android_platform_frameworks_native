{
  "comments": [
    {
      "key": {
        "uuid": "a1ff2ddf_88723a7a",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2017-11-03T10:43:00Z",
      "side": 1,
      "message": "Why?",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b766aca_3be235a3",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-11-03T16:04:02Z",
      "side": 1,
      "message": "There is still nontrivial compile-time impact for the generation. I don\u0027t think we want to see this for:\n\n* first boot\n* after OTA\n* after boot\n* first install/update",
      "parentUuid": "a1ff2ddf_88723a7a",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9278ea21_7fba4a8d",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2017-11-03T16:07:44Z",
      "side": 1,
      "message": "\u003e There is still nontrivial compile-time impact for the generation. I\n \u003e don\u0027t think we want to see this for:\n \u003e \n \u003e * first boot\n \u003e * after OTA\n \u003e * after boot\n \u003e * first install/update\n\nDo you have numbers on compile-time impact?\n\nThe downside of not doing it is that sometimes you\u0027ll get debug data, sometimes not, who knows. I think I\u0027d prefer consistency.",
      "parentUuid": "9b766aca_3be235a3",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "600e631a_8f003e43",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1022077
      },
      "writtenOn": "2017-11-03T18:00:00Z",
      "side": 1,
      "message": "The inconsistency might cause some confusion for developers.\n\nHow much extra time does it take? Are we at risk to timeout on low end devices?",
      "parentUuid": "9278ea21_7fba4a8d",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5069e10_d2cb9fa0",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-11-03T18:38:16Z",
      "side": 1,
      "message": "Re inconsistency: that would only be for JNI methods (as that\u0027s the only thing compiled otherwise). I assert that\u0027s not important, compared to interpreter frames right now.\n\nHowever, I reran experiments, and for a well-known large app, it seems insignificant overhead at this point in time (~1%). So PS2 will change the setup.",
      "parentUuid": "600e631a_8f003e43",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee27b462_83077e49",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2017-11-06T09:12:17Z",
      "side": 1,
      "message": "\u003e Re inconsistency: that would only be for JNI methods (as that\u0027s the\n \u003e only thing compiled otherwise). I assert that\u0027s not important,\n \u003e compared to interpreter frames right now.\n\nI\u0027m confused. Your original concerns were about compile-time, but if it is only impacting JNI methods, that should be close to nothing. Was there anything else?\n\n \u003e \n \u003e However, I reran experiments, and for a well-known large app, it\n \u003e seems insignificant overhead at this point in time (~1%). So PS2\n \u003e will change the setup.\n\nThe number is ~1% extra compile-time per method?",
      "parentUuid": "e5069e10_d2cb9fa0",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c29a60c2_59e7c11c",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1041833
      },
      "writtenOn": "2017-11-06T15:58:27Z",
      "side": 1,
      "message": "\u003e \u003e Re inconsistency: that would only be for JNI methods (as that\u0027s the\n\u003e  \u003e only thing compiled otherwise). I assert that\u0027s not important,\n\u003e  \u003e compared to interpreter frames right now.\n\u003e \n\u003e I\u0027m confused. Your original concerns were about compile-time, but if it is only impacting JNI methods, that should be close to nothing. Was there anything else?\n\nThe argument should be the other way around, if we\u0027re only missing JNI methods, we lose next to nothing (compared to all the interpreter / JIT frames), so price-value is always bad.\n\n\u003e \n\u003e  \u003e \n\u003e  \u003e However, I reran experiments, and for a well-known large app, it\n\u003e  \u003e seems insignificant overhead at this point in time (~1%). So PS2\n\u003e  \u003e will change the setup.\n\u003e \n\u003e The number is ~1% extra compile-time per method?\n\nComplete dex2oat overhead.",
      "parentUuid": "ee27b462_83077e49",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "194412d4_0557438f",
        "filename": "cmds/installd/dexopt.cpp",
        "patchSetId": 1
      },
      "lineNbr": 294,
      "author": {
        "id": 1038443
      },
      "writtenOn": "2017-11-06T16:04:27Z",
      "side": 1,
      "message": "\u003e \u003e \u003e Re inconsistency: that would only be for JNI methods (as that\u0027s\n \u003e the\n \u003e \u003e  \u003e only thing compiled otherwise). I assert that\u0027s not important,\n \u003e \u003e  \u003e compared to interpreter frames right now.\n \u003e \u003e\n \u003e \u003e I\u0027m confused. Your original concerns were about compile-time, but\n \u003e if it is only impacting JNI methods, that should be close to\n \u003e nothing. Was there anything else?\n \u003e \n \u003e The argument should be the other way around, if we\u0027re only missing\n \u003e JNI methods, we lose next to nothing (compared to all the\n \u003e interpreter / JIT frames), so price-value is always bad.\n\nI\u0027d put consistency higher in the list when making such decisions.\n\n \u003e \n \u003e \u003e\n \u003e \u003e  \u003e\n \u003e \u003e  \u003e However, I reran experiments, and for a well-known large app,\n \u003e it\n \u003e \u003e  \u003e seems insignificant overhead at this point in time (~1%). So\n \u003e PS2\n \u003e \u003e  \u003e will change the setup.\n \u003e \u003e\n \u003e \u003e The number is ~1% extra compile-time per method?\n \u003e \n \u003e Complete dex2oat overhead.",
      "parentUuid": "c29a60c2_59e7c11c",
      "range": {
        "startLine": 294,
        "startChar": 59,
        "endLine": 294,
        "endChar": 81
      },
      "revId": "ecf85c5fb82543918abcf8f38ff3b376f3f13c03",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}